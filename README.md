This code is mostly from varren youtube video.
I wrote my version after reading his code for learning purposes. 